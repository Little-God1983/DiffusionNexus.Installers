<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:DiffusionNexus.Installers.ViewModels"
             x:Class="DiffusionNexus.Installers.Views.InstallationView"
             x:DataType="vm:InstallationViewModel">

    <UserControl.Styles>
        <!-- Gradient Background Style -->
        <Style Selector="Border.main-container">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                        <GradientStop Color="#1a1a2e" Offset="0"/>
                        <GradientStop Color="#16213e" Offset="0.5"/>
                        <GradientStop Color="#0f3460" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Card Style -->
        <Style Selector="Border.card">
            <Setter Property="Background" Value="#2a2a4a"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="BoxShadow" Value="0 4 20 0 #40000000"/>
        </Style>

        <!-- Primary Button Style -->
        <Style Selector="Button.primary-btn">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                        <GradientStop Color="#667eea" Offset="0"/>
                        <GradientStop Color="#764ba2" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="Padding" Value="40,16"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style Selector="Button.primary-btn:pointerover">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                        <GradientStop Color="#764ba2" Offset="0"/>
                        <GradientStop Color="#667eea" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
        </Style>

        <Style Selector="Button.primary-btn:disabled">
            <Setter Property="Background" Value="#555577"/>
            <Setter Property="Foreground" Value="#888888"/>
        </Style>

        <!-- Browse Button Style -->
        <Style Selector="Button.browse-btn">
            <Setter Property="Background" Value="#4a4a6a"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="16,12"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style Selector="Button.browse-btn:pointerover">
            <Setter Property="Background" Value="#5a5a7a"/>
        </Style>

        <!-- Social Link Button Style -->
        <Style Selector="Button.social-btn">
            <Setter Property="Background" Value="#3a3a5a"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#4a4a6a"/>
        </Style>

        <Style Selector="Button.social-btn:pointerover">
            <Setter Property="Background" Value="#4a4a6a"/>
            <Setter Property="BorderBrush" Value="#667eea"/>
        </Style>

        <!-- VRAM Toggle Button Style -->
        <Style Selector="ToggleButton.vram-toggle">
            <Setter Property="Background" Value="#3a3a5a"/>
            <Setter Property="Foreground" Value="#aaaacc"/>
            <Setter Property="Padding" Value="16,12"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="BorderBrush" Value="#4a4a6a"/>
            <Setter Property="MinWidth" Value="75"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style Selector="ToggleButton.vram-toggle:pointerover">
            <Setter Property="Background" Value="#4a4a6a"/>
            <Setter Property="BorderBrush" Value="#667eea"/>
        </Style>

        <Style Selector="ToggleButton.vram-toggle:checked">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                        <GradientStop Color="#667eea" Offset="0"/>
                        <GradientStop Color="#764ba2" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#764ba2"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>

        <!-- Log Box Style -->
        <Style Selector="ListBox.log-box">
            <Setter Property="Background" Value="#1a1a2a"/>
            <Setter Property="BorderBrush" Value="#3a3a5a"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
        </Style>

        <!-- Disclaimer Card Style -->
        <Style Selector="Border.disclaimer-card">
            <Setter Property="Background" Value="#3a1a1a"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="BorderBrush" Value="#ff4444"/>
            <Setter Property="BoxShadow" Value="0 4 20 0 #40ff0000"/>
        </Style>

        <!-- Progress Bar Style -->
        <Style Selector="ProgressBar.styled-progress">
            <Setter Property="Height" Value="24"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Background" Value="#2a2a4a"/>
            <Setter Property="Foreground">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                        <GradientStop Color="#00c6ff" Offset="0"/>
                        <GradientStop Color="#0072ff" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Styles>

    <Border Classes="main-container">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="40" Spacing="30" MaxWidth="900" HorizontalAlignment="Center">

               

                <!-- Banner Image -->
                <Border CornerRadius="16"
                        ClipToBounds="True"
                        BoxShadow="0 8 30 0 #60000000"
                        HorizontalAlignment="Center">
                    <Image Source="avares://DiffusionNexus.Installers/Assets/Banner-cut.png"
                           MaxHeight="200"
                           Stretch="Uniform"/>
                </Border>

                <!-- Welcome Title -->
                <StackPanel HorizontalAlignment="Center" Spacing="8">
                    <TextBlock Text="ComfyUI Workload Installer"
                               FontSize="32"
                               FontWeight="Bold"
                               HorizontalAlignment="Center">
                        <TextBlock.Foreground>
                            <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                                <GradientStop Color="#667eea" Offset="0"/>
                                <GradientStop Color="#764ba2" Offset="0.5"/>
                                <GradientStop Color="#00c6ff" Offset="1"/>
                            </LinearGradientBrush>
                        </TextBlock.Foreground>
                    </TextBlock>
                </StackPanel>

                <!-- Configuration Selection Card -->
                <Border Classes="card">
                    <StackPanel Spacing="12">
                        <TextBlock Text="Configuration"
                                   FontSize="18"
                                   FontWeight="SemiBold"
                                   Foreground="White"/>
                        <TextBlock Text="Select a saved configuration to use for installation"
                                   FontSize="14"
                                   Foreground="#8888aa"/>
                        <ComboBox ItemsSource="{Binding SavedConfigurations}"
                                  SelectedItem="{Binding SelectedSavedConfiguration}"
                                  PlaceholderText="Select a configuration..."
                                  Background="#1a1a2a"
                                  Foreground="White"
                                  BorderBrush="#3a3a5a"
                                  CornerRadius="6"
                                  Padding="12,10"
                                  FontSize="14"
                                  HorizontalAlignment="Stretch">
                            <ComboBox.ItemTemplate>
                                <DataTemplate DataType="vm:ConfigurationSelectionItem">
                                    <TextBlock Text="{Binding Display}"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </StackPanel>
                </Border>

                <!-- Folder Picker Card -->
                <Border Classes="card">
                    <StackPanel Spacing="12">
                        <TextBlock Text="Target Installation Folder"
                                   FontSize="18"
                                   FontWeight="SemiBold"
                                   Foreground="White"/>
                        <TextBlock Text="Select the folder where ComfyUI will be installed"
                                   FontSize="14"
                                   Foreground="#8888aa"/>
                        <Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
                            <TextBox Grid.Column="0"
                                     Text="{Binding TargetInstallFolder}"
                                     Watermark="Click Browse to select a folder..."
                                     Background="#1a1a2a"
                                     Foreground="White"
                                     BorderBrush="#3a3a5a"
                                     CornerRadius="6"
                                     Padding="12,10"
                                     FontSize="14"/>
                            <Button Grid.Column="1"
                                    Classes="browse-btn"
                                    Content="Browse"
                                    Command="{Binding BrowseTargetFolderCommand}"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- VRAM Profile Card -->
                <Border Classes="card" IsVisible="{Binding IsVramProfileVisible}">
                    <StackPanel Spacing="16">
                        <StackPanel Spacing="4">
                            <TextBlock Text="VRAM Profile"
                                       FontSize="18"
                                       FontWeight="SemiBold"
                                       Foreground="White"/>
                            <TextBlock Text="Select your GPU's VRAM size for optimized settings"
                                       FontSize="14"
                                       Foreground="#8888aa"/>
                        </StackPanel>
                        <ItemsControl ItemsSource="{Binding AvailableVramProfiles}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal" 
                                               HorizontalAlignment="Center"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate DataType="vm:VramProfileOption">
                                    <ToggleButton Classes="vram-toggle"
                                                  Content="{Binding DisplayName}"
                                                  IsChecked="{Binding IsSelected}"
                                                  Margin="4"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>

                <!-- Installation Type Card -->
                <Border Classes="card">
                    <StackPanel Spacing="16">
                        <StackPanel Spacing="4">
                            <TextBlock Text="Installation Type"
                                       FontSize="18"
                                       FontWeight="SemiBold"
                                       Foreground="White"/>
                            <TextBlock Text="Choose what to install"
                                       FontSize="14"
                                       Foreground="#8888aa"/>
                        </StackPanel>
                        <ItemsControl ItemsSource="{Binding AvailableInstallationTypes}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal" 
                                               HorizontalAlignment="Center"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate DataType="vm:InstallationTypeOption">
                                    <ToggleButton Classes="vram-toggle"
                                                  Content="{Binding DisplayName}"
                                                  IsChecked="{Binding IsSelected}"
                                                  Margin="4"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>
                 <!-- Social Links Bar -->
                <Border Classes="card" Padding="16">
                    <StackPanel Orientation="Horizontal" 
                                HorizontalAlignment="Center" 
                                Spacing="16">

                        <Button Classes="social-btn" 
                                Command="{Binding OpenYoutubeCommand}"
                                ToolTip.Tip="Visit our YouTube channel">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <Image Source="avares://DiffusionNexus.Installers/Assets/yt.png" 
                                       Width="24" Height="24"/>
                                <TextBlock Text="YouTube" 
                                           VerticalAlignment="Center"
                                           FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button>
                        <Button Classes="social-btn" 
                                Command="{Binding OpenPatreonCommand}"
                                ToolTip.Tip="Support us on Patreon">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <Image Source="avares://DiffusionNexus.Installers/Assets/patreon.png" 
                                       Width="24" Height="24"/>
                                <TextBlock Text="Patreon" 
                                           VerticalAlignment="Center"
                                           FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button>
                        <Button Classes="social-btn" 
                                Command="{Binding OpenCivitaiCommand}"
                                ToolTip.Tip="Check out our models on Civitai">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <Image Source="avares://DiffusionNexus.Installers/Assets/civitai.png" 
                                       Width="24" Height="24"/>
                                <TextBlock Text="Civitai" 
                                           VerticalAlignment="Center"
                                           FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </Border>

                <!-- Disclaimer Section -->
                <Border Classes="disclaimer-card">
                    <StackPanel Spacing="12">
                        <TextBlock Text="📋 SOFTWARE DISCLAIMER"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   Foreground="#ff6b6b"
                                   HorizontalAlignment="Center"/>
                        <TextBlock TextWrapping="Wrap"
                                   FontSize="14"
                                   FontWeight="Bold"
                                   Foreground="#ff8888"
                                   TextAlignment="Center"
                                   LineHeight="22">
                            <TextBlock.Text>This software is NOT for sale. It is provided as FREE and OPEN-SOURCE software.
By using this software, you acknowledge that NO legal action of any kind can be taken against the developer(s).
This software is provided "AS IS" without warranty of any kind, express or implied.
Use at your own risk.</TextBlock.Text>
                        </TextBlock>
                        <CheckBox IsChecked="{Binding DisclaimerAccepted}"
                                  HorizontalAlignment="Center"
                                  Margin="0,8,0,0"
                                  Cursor="Hand">
                            <TextBlock Text="I have read and accept the disclaimer above"
                                       Foreground="#ffaaaa"
                                       FontWeight="SemiBold"
                                       FontSize="14"/>
                        </CheckBox>
                    </StackPanel>
                </Border>
              
                <!-- Start/Cancel Button with Checklist -->
                <Border Classes="card">
                    <Grid ColumnDefinitions="*,Auto,*">
                        <!-- Requirements Checklist -->
                        <StackPanel Grid.Column="0" 
                                    Spacing="12" 
                                    VerticalAlignment="Center"
                                    Margin="0,0,20,0">
                            <TextBlock Text="Installation Requirements"
                                       FontSize="16"
                                       FontWeight="SemiBold"
                                       Foreground="White"
                                       Margin="0,0,0,8"/>
                            
                            <!-- Configuration Selected -->
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <Panel Width="28" Height="28">
                                    <Border Width="28" Height="28" CornerRadius="14"
                                            Background="#444466"
                                            IsVisible="{Binding SelectedSavedConfiguration, Converter={x:Static ObjectConverters.IsNull}}"/>
                                    <Border Width="28" Height="28" CornerRadius="14"
                                            Background="#44aa44"
                                            IsVisible="{Binding SelectedSavedConfiguration, Converter={x:Static ObjectConverters.IsNotNull}}">
                                        <TextBlock Text="✓"
                                                   FontSize="16"
                                                   FontWeight="Bold"
                                                   Foreground="White"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"/>
                                    </Border>
                                </Panel>
                                <StackPanel>
                                    <TextBlock Text="Configuration selected"
                                               FontSize="14"
                                               Foreground="#88ff88"
                                               IsVisible="{Binding SelectedSavedConfiguration, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                    <TextBlock Text="Configuration selected"
                                               FontSize="14"
                                               Foreground="#888899"
                                               IsVisible="{Binding SelectedSavedConfiguration, Converter={x:Static ObjectConverters.IsNull}}"/>
                                </StackPanel>
                            </StackPanel>
                            
                            <!-- Target Folder Selected -->
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <Panel Width="28" Height="28">
                                    <Border Width="28" Height="28" CornerRadius="14"
                                            Background="#444466"
                                            IsVisible="{Binding TargetInstallFolder, Converter={x:Static StringConverters.IsNullOrEmpty}}"/>
                                    <Border Width="28" Height="28" CornerRadius="14"
                                            Background="#44aa44"
                                            IsVisible="{Binding TargetInstallFolder, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                                        <TextBlock Text="✓"
                                                   FontSize="16"
                                                   FontWeight="Bold"
                                                   Foreground="White"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"/>
                                    </Border>
                                </Panel>
                                <StackPanel>
                                    <TextBlock Text="Target folder selected"
                                               FontSize="14"
                                               Foreground="#88ff88"
                                               IsVisible="{Binding TargetInstallFolder, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                    <TextBlock Text="Target folder selected"
                                               FontSize="14"
                                               Foreground="#888899"
                                               IsVisible="{Binding TargetInstallFolder, Converter={x:Static StringConverters.IsNullOrEmpty}}"/>
                                </StackPanel>
                            </StackPanel>
                            
                            <!-- Disclaimer Accepted -->
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <Panel Width="28" Height="28">
                                    <Border Width="28" Height="28" CornerRadius="14"
                                            Background="#444466"
                                            IsVisible="{Binding !DisclaimerAccepted}"/>
                                    <Border Width="28" Height="28" CornerRadius="14"
                                            Background="#44aa44"
                                            IsVisible="{Binding DisclaimerAccepted}">
                                        <TextBlock Text="✓"
                                                   FontSize="16"
                                                   FontWeight="Bold"
                                                   Foreground="White"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"/>
                                    </Border>
                                </Panel>
                                <StackPanel>
                                    <TextBlock Text="Disclaimer accepted"
                                               FontSize="14"
                                               Foreground="#88ff88"
                                               IsVisible="{Binding DisclaimerAccepted}"/>
                                    <TextBlock Text="Disclaimer accepted"
                                               FontSize="14"
                                               Foreground="#888899"
                                               IsVisible="{Binding !DisclaimerAccepted}"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                        
                        <!-- Center: Start/Cancel Button -->
                        <StackPanel Grid.Column="1" 
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Center">
                            <Button Classes="primary-btn"
                                    Content="🚀 Start Installation"
                                    Command="{Binding StartInstallationCommand}"
                                    IsVisible="{Binding !IsInstalling}"
                                    MinWidth="250"/>
                            <Button Content="⏹ Cancel Installation"
                                    Command="{Binding StartInstallationCancelCommand}"
                                    IsVisible="{Binding IsInstalling}"
                                    Foreground="White"
                                    FontWeight="Bold"
                                    FontSize="18"
                                    Padding="40,16"
                                    CornerRadius="8"
                                    Cursor="Hand"
                                    Background="#cc4444"
                                    MinWidth="250"/>
                        </StackPanel>
                        
                        <!-- Right side: Status indicator -->
                        <StackPanel Grid.Column="2" 
                                    Spacing="8" 
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Right"
                                    Margin="20,0,0,0"
                                    IsVisible="{Binding !IsInstalling}">
                            <!-- Ready state -->
                            <Border Padding="20,16"
                                    CornerRadius="12"
                                    Background="#1a3a1a"
                                    BorderBrush="#44aa44"
                                    BorderThickness="2"
                                    IsVisible="{Binding IsReadyToInstall}">
                                <StackPanel Spacing="4" HorizontalAlignment="Center">
                                    <TextBlock Text="✅"
                                               FontSize="28"
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="Ready to Install"
                                               FontSize="14"
                                               FontWeight="Bold"
                                               Foreground="#88ff88"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <!-- Not ready state -->
                            <Border Padding="20,16"
                                    CornerRadius="12"
                                    Background="#3a2a1a"
                                    BorderBrush="#aa6644"
                                    BorderThickness="2"
                                    IsVisible="{Binding !IsReadyToInstall}">
                                <StackPanel Spacing="4" HorizontalAlignment="Center">
                                    <TextBlock Text="⚠️"
                                               FontSize="28"
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="Complete all steps"
                                               FontSize="14"
                                               FontWeight="Bold"
                                               Foreground="#ffaa44"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                        
                        <!-- Installing state indicator -->
                        <Border Grid.Column="2"
                                Padding="20,16"
                                CornerRadius="12"
                                Background="#1a2a3a"
                                BorderBrush="#4488cc"
                                BorderThickness="2"
                                IsVisible="{Binding IsInstalling}"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Right"
                                Margin="20,0,0,0">
                            <StackPanel Spacing="4" HorizontalAlignment="Center">
                                <TextBlock Text="⏳"
                                           FontSize="28"
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Installing..."
                                           FontSize="14"
                                           FontWeight="Bold"
                                           Foreground="#88aaff"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>
                <!-- Progress Section -->
                <Border Classes="card">
                    <StackPanel Spacing="16">
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Text="Installation Progress"
                                       FontSize="18"
                                       FontWeight="SemiBold"
                                       Foreground="White"/>
                            <TextBlock Grid.Column="1"
                                       Text="{Binding StatusMessage}"
                                       FontSize="14"
                                       Foreground="#aaaacc"
                                       VerticalAlignment="Center"/>
                        </Grid>
                        <ProgressBar Classes="styled-progress"
                                     Value="{Binding ProgressValue}"
                                     Maximum="{Binding ProgressMaximum}"
                                     ShowProgressText="True"/>
                    </StackPanel>
                </Border>
                <!-- Log Box Card -->
                <Border Classes="card" MinHeight="250">
                    <DockPanel>
                        <Grid DockPanel.Dock="Top" ColumnDefinitions="*,Auto" Margin="0,0,0,12">
                            <StackPanel Grid.Column="0" Spacing="4">
                                <TextBlock Text="Installation Log"
                                           FontSize="18"
                                           FontWeight="SemiBold"
                                           Foreground="White"/>
                                <TextBlock Text="Real-time installation progress and messages"
                                           FontSize="14"
                                           Foreground="#8888aa"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1" 
                                        Orientation="Horizontal" 
                                        Spacing="8" 
                                        VerticalAlignment="Center">
                                <Button Classes="browse-btn"
                                        Content="📋 Copy"
                                        Command="{Binding CopyLogToClipboardCommand}"
                                        ToolTip.Tip="Copy log to clipboard"/>
                                <Button Classes="browse-btn"
                                        Content="💾 Export"
                                        Command="{Binding ExportLogCommand}"
                                        ToolTip.Tip="Export log to text file"/>
                            </StackPanel>
                        </Grid>
                        <ListBox Classes="log-box"
                                 ItemsSource="{Binding LogEntries}"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                 SelectionMode="Single">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Display}"
                                               Foreground="{Binding ForegroundBrush}"
                                               FontFamily="Consolas, Courier New, monospace"
                                               FontSize="13"
                                               TextWrapping="Wrap"
                                               Padding="8,4"/>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </DockPanel>
                </Border>

         

            </StackPanel>
        </ScrollViewer>
    </Border>
</UserControl>